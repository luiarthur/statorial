
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Intro">Intro<a class="anchor-link" href="#Intro"> </a></h2><p>In this post, I'll demonstrate how to fit a linear model using ADVI in this tutorial. Note that
the link to the repository containing the <code>advi.ModelParam</code> class and this jupyter notebook is
included above.</p>
<p>ADVI is a way of implementing variational inference without having to manually compute derivatives, 
in the presence of automatic differentiation libraries. It is typically faster, and easier to implement
than tradititional MCMC methods. While, MCMC is still considered the gold standard in Bayesian applications,
variational inference enables the exploration of many models quickly. PyTorch is a great python library 
for these types of implementations, as it supports the creation of complex computational graphs and automatic 
differentiation.</p>
<hr>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implementation">Implementation<a class="anchor-link" href="#Implementation"> </a></h2><p>This cell contains the libraries we will need.
The only note-worthy import is <code>advi</code> (link below), which contains a single class called <code>ModelParam</code>.
You'll note that <code>ModelParam</code> holds <code>vp</code> (a tensor) and <code>size</code>, which is the dimensions of the model parameters.
On initialization, this object creates the variational parameters -- a mean and a logged-standard deviation to a
Normal distribution. These parameters are optimized until the ELBO is maximized. The SD is logged so that 
it can be optimized in an unconstrained fashion. Recall that in ADVI, the variational distribution is placed 
on model parameters transformed to the real space. The advantages enjoyed by doing so include (1) being able
to re-parameterize the distribution so as to sample from a parameter free (standard Normal) distribution, 
to take the gradients of random draws from the variational distribution; and (2) modeling correlation
between parameters, if desired.</p>
<p>I also included a helper function <code>Timer</code>, which is in the file <code>Timer</code>.</p>
<p>I may expound on ADVI later, but for now, refer to the <a href="https://arxiv.org/pdf/1603.00788.pdf">ADVI paper</a> for more details...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.distributions</span> <span class="k">import</span> <span class="n">Normal</span><span class="p">,</span> <span class="n">Gamma</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">import</span> <span class="nn">advi</span>
<span class="kn">import</span> <span class="nn">Timer</span>

<span class="c1"># Set default type to float64 (instead of float32)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">set_default_dtype</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The linear model is:</p>
$$
\begin{split}
y_i \mid \sigma, \beta &amp;\sim \text{Normal}(\beta_0 + \beta_1 x_i, \sigma), \text{ for } i = 1,\cdots, N\\
\beta_k &amp;\sim \text{Normal}(0, 1), \text{ for } k = 0, 1 \\
\sigma &amp;\sim \text{Gamma}(1, 1). \\
\end{split}
$$<p>We encode this in the following cells. Note that we need to implement</p>
<ol>
<li>log-likelihood</li>
<li>the log of the prior density times absolute value of the determinant of the jacobian (since we are transforming the parameters onto the real scale)</li>
<li>the log of the variational density (evaluated at the parameters sampled from the variational distribution)</li>
<li>the elbo, which is done as follows:<ul>
<li>sample model parameters (on the real scale) from the variational distributions<ul>
<li>recall that to obtain parameter-samples, we first draw from a standard Normal, 
and then multiply the sd of the variational parameter to the standard Normal, 
and then add the variational parameter's mean.</li>
</ul>
</li>
<li>transform the real-valued parameters to their support (in this case only sigma needs to be exponentiated).</li>
<li>Evaluate: ELBO = (1) + (2) - (3)</li>
</ul>
</li>
</ol>
<p>One more thing to note here is that I multiplied the likelihood by the size of the full data, and divided by the size of the
current data (hence the <code>mean(0)</code> in the return line of <code>loglike</code>). This enables stochastic variational inference, in
which minibatches are employed. This can lead to huge speed-ups when analyzing large data-sets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">log_prior_plus_logabsdet_J</span><span class="p">(</span><span class="n">real_params</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="c1"># log prior for beta, evaluated at sampled values for beta</span>
    <span class="n">lp_b</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">real_params</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="c1"># log prior sig + log jacobian</span>
    <span class="n">lp_log_sig</span> <span class="o">=</span> <span class="p">(</span><span class="n">Gamma</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">real_params</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">lp_b</span> <span class="o">+</span> <span class="n">lp_log_sig</span>

<span class="k">def</span> <span class="nf">loglike</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">full_data_size</span><span class="p">):</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span>
    <span class="n">sig</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Normal</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">beta</span><span class="p">),</span> <span class="n">sig</span><span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">full_data_size</span>

<span class="k">def</span> <span class="nf">log_q</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">real_params</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">model_params</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="n">model_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">log_q</span><span class="p">(</span><span class="n">real_params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">out</span>

<span class="k">def</span> <span class="nf">elbo</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">model_params</span><span class="p">,</span> <span class="n">full_data_size</span><span class="p">):</span>
    <span class="n">real_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">model_params</span><span class="p">:</span>
        <span class="n">real_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">rsample</span><span class="p">()</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="n">real_params</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">],</span>
              <span class="s1">&#39;sig&#39;</span><span class="p">:</span> <span class="n">real_params</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">exp</span><span class="p">()}</span>

    <span class="n">out</span> <span class="o">=</span> <span class="n">loglike</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">full_data_size</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">+=</span> <span class="n">log_prior_plus_logabsdet_J</span><span class="p">(</span><span class="n">real_params</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span> 
    <span class="n">out</span> <span class="o">-=</span> <span class="n">log_q</span><span class="p">(</span><span class="n">model_params</span><span class="p">,</span> <span class="n">real_params</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">out</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we are ready to fit the model. For reproducibility, I will set seeds for the random number generators.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># set random number generator seeds for reproducibility</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now generate some data. We will use 1000 samples. Note that the true values of the parameters are 
$\beta = (2, -3)$ and $\sigma = 0.5$. I've included a plot of the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Generate data</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.</span><span class="p">])</span>
<span class="n">sig</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Normal</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">beta</span><span class="p">),</span> <span class="n">sig</span><span class="p">)</span><span class="o">.</span><span class="n">rsample</span><span class="p">()</span>

<span class="c1"># Plot data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model is fit in this cell. We first define the model parameters in <code>model_params</code> in a dictionary.
All only need to specify the size for the initialization, the initial values for the variational parameters are drawn from a standard normal.
Recall that the variational parameters are the mean and SD of the Normal, but the SD is stored as the logged SD in the class.</p>
<p>We use the Adam optimizer with a learning rate of 0.1. This may seem large, but we will see that it is not.</p>
<p>We do Stochastic gradient descent (SGD) for 1000 iterations. Each iteration, we subsample 100 observations from the original data.
We compute the loss (as torch minimizes objectives) by computing the negative of the elbo divided by the size of the full data ($N$).
Dividing the elbo by $N$ allows us to use a larger learning rate (<code>lr</code>). This is not a huge deal, but most of the time, I can
just use a default learning rate of 0.1 by scaling the ELBO.</p>
<p>You need to manually set the gradients to zero before computing the gradients (in <code>loss.backward()</code>, as the default behavior 
of the library is to accumulate gradients. <code>loss.backward()</code> signals the gradient computation. <code>optimizer.step()</code> signals
the modification of the (variational) parameters based on the gradients.</p>
<p>I print out statements to show the progression of the model fitting. As you can see, it takes only a few second to get decent results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="n">advi</span><span class="o">.</span><span class="n">ModelParam</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">k</span><span class="p">),</span> <span class="s1">&#39;sig&#39;</span><span class="p">:</span> <span class="n">advi</span><span class="o">.</span><span class="n">ModelParam</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)}</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">([</span><span class="n">model_params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">vp</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">model_params</span><span class="p">],</span> <span class="n">lr</span><span class="o">=.</span><span class="mi">1</span><span class="p">)</span>
<span class="n">elbo_hist</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">3000</span>
<span class="n">minibatch_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">with</span> <span class="n">Timer</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="s1">&#39;LinReg&#39;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="n">sample_with_replacement</span> <span class="o">=</span> <span class="n">minibatch_size</span> <span class="o">&gt;</span> <span class="n">N</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="n">sample_with_replacement</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span><span class="n">elbo</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:],</span> <span class="n">model_params</span><span class="p">,</span> <span class="n">full_data_size</span><span class="o">=</span><span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
        <span class="n">elbo_hist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">max_iter</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> | </span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1"> | elbo: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="p">,</span> <span class="n">elbo_hist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>2019-03-04 10:25:33.372050 | 300/3000 | elbo: -1.0809662443934889
2019-03-04 10:25:34.279941 | 600/3000 | elbo: -0.9788739108056087
2019-03-04 10:25:35.105291 | 900/3000 | elbo: -0.787416569401845
2019-03-04 10:25:35.699862 | 1200/3000 | elbo: -0.6659829367538607
2019-03-04 10:25:36.468941 | 1500/3000 | elbo: -0.9046671115373425
2019-03-04 10:25:37.377309 | 1800/3000 | elbo: -0.7568028262801675
2019-03-04 10:25:38.174697 | 2100/3000 | elbo: -0.8323859598019949
2019-03-04 10:25:38.940130 | 2400/3000 | elbo: -0.7649339142340957
2019-03-04 10:25:39.715243 | 2700/3000 | elbo: -0.7485436957245089
2019-03-04 10:25:40.480584 | 3000/3000 | elbo: -0.8149846174077103
LinReg time: 9s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We plot the elbo history, which seems to indicate convergence.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">elbo_hist</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;complete elbo history&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">elbo_hist</span><span class="p">[</span><span class="mi">1000</span><span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;tail of elbo history&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We inspect the statistics of the posterior in this cell.
The posterior mean and SD are printed. They are consistent with the true values.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Inspect posterior</span>
<span class="n">nsamps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sig_post</span> <span class="o">=</span> <span class="n">model_params</span><span class="p">[</span><span class="s1">&#39;sig&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rsample</span><span class="p">([</span><span class="n">nsamps</span><span class="p">])</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;True beta: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">beta</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;beta mean: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model_params</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;beta sd: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model_params</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;True sigma: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sig mean: </span><span class="si">{}</span><span class="s1"> | sig sd: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sig_post</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sig_post</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>True beta: [ 2. -3.]
beta mean: [ 1.99261651 -3.08685974]
beta sd: [0.02348989 0.01433442]

True sigma: 0.5
sig mean: 0.5246806551477153 | sig sd: 0.025474980282757603
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This concludes this tutorial. I hope you found it useful. I will be posting a few more examples, including</p>
<ul>
<li>Logistic regression</li>
<li>Gaussian mixture models (and how to get cluster membership)</li>
<li>handling missing values</li>
</ul>

</div>
</div>
</div>
 

